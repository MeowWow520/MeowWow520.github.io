{"title":"","type":"page","uid":"1cd19fc71517798e2fa5b7457d1fb06e","text":"class MatrixStack { static reset() { this.depth = 0; } static loadIdentity() { for (let i = 0; i < 16; i++) { this.currentMatrix[i] = i % 5 ...","date":"2025-11-18T04:43:50.319Z","updated":"2025-11-18T04:43:50.319Z","comments":true,"path":"api/pages/live2d-widget/build/cubism2/utils/MatrixStack.js","covers":null,"content":"class MatrixStack {\n    static reset() {\n        this.depth = 0;\n    }\n    static loadIdentity() {\n        for (let i = 0; i < 16; i++) {\n            this.currentMatrix[i] = i % 5 == 0 ? 1 : 0;\n        }\n    }\n    static push() {\n        const offset = this.depth * 16;\n        const nextOffset = (this.depth + 1) * 16;\n        if (this.matrixStack.length < nextOffset + 16) {\n            this.matrixStack.length = nextOffset + 16;\n        }\n        for (let i = 0; i < 16; i++) {\n            this.matrixStack[nextOffset + i] = this.currentMatrix[i];\n        }\n        this.depth++;\n    }\n    static pop() {\n        this.depth--;\n        if (this.depth < 0) {\n            this.depth = 0;\n        }\n        const offset = this.depth * 16;\n        for (let i = 0; i < 16; i++) {\n            this.currentMatrix[i] = this.matrixStack[offset + i];\n        }\n    }\n    static getMatrix() {\n        return this.currentMatrix;\n    }\n    static multMatrix(matNew) {\n        let i, j, k;\n        for (i = 0; i < 16; i++) {\n            this.tmp[i] = 0;\n        }\n        for (i = 0; i < 4; i++) {\n            for (j = 0; j < 4; j++) {\n                for (k = 0; k < 4; k++) {\n                    this.tmp[i + j * 4] +=\n                        this.currentMatrix[i + k * 4] * matNew[k + j * 4];\n                }\n            }\n        }\n        for (i = 0; i < 16; i++) {\n            this.currentMatrix[i] = this.tmp[i];\n        }\n    }\n}\nMatrixStack.matrixStack = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\nMatrixStack.depth = 0;\nMatrixStack.currentMatrix = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\nMatrixStack.tmp = new Array(16);\nexport default MatrixStack;\n","count_time":{"symbolsCount":"1.7k","symbolsTime":"2 mins."},"toc":"","data":[]}